<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dd.ai_medical_triage.dao.mapper.ChatMessageMapper">

    <!-- 结果集映射：匹配ChatMessage实体与chat_message表字段（无需重复指定typeHandler） -->
    <resultMap id="BaseResultMap" type="com.dd.ai_medical_triage.entity.ChatMessage">
        <id column="chat_message_id" property="chatMessageId"/>
        <result column="chat_session_id" property="chatSessionId"/>
        <result column="message_type" property="messageType"/>
        <result column="content" property="content"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>

    <!-- 基础字段SQL片段，减少冗余 -->
    <sql id="Base_Column_List">
        chat_message_id, chat_session_id, message_type, content, create_time, update_time
    </sql>

    <!-- ==================== SQL 语句 ==================== -->

    <!-- 批量插入会话消息 -->
    <insert id="batchInsert" parameterType="java.util.List">
        INSERT INTO chat_message (
        <include refid="Base_Column_List"/>
        ) VALUES
        <foreach collection="list" item="item" separator=",">
            (
            #{item.chatSessionId},
            #{item.messageType},
            #{item.content},
            #{item.createdTime},
            #{item.messageType}
            )
        </foreach>
    </insert>

</mapper>